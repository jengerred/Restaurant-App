{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/jennifergerred/Documents/MIT/Week 28/restaurant/components/default.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\n/* hocs/defaultPage.js */\nimport React from \"react\";\nimport Router from \"next/router\";\nimport { getUserFromServerCookie, getUserFromLocalCookie } from \"./auth\";\nexport default (function (Page) {\n  var _temp;\n\n  return _temp = /*#__PURE__*/function (_React$Component) {\n    _inherits(DefaultPage, _React$Component);\n\n    var _super = _createSuper(DefaultPage);\n\n    function DefaultPage() {\n      var _this;\n\n      _classCallCheck(this, DefaultPage);\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      _this = _super.call.apply(_super, [this].concat(args));\n\n      _defineProperty(_assertThisInitialized(_this), \"logout\", function (eve) {\n        if (eve.key === \"logout\") {\n          Router.push(\"/?logout=\".concat(eve.newValue));\n        }\n      });\n\n      return _this;\n    }\n\n    _createClass(DefaultPage, [{\n      key: \"componentDidMount\",\n      value: function componentDidMount() {\n        window.addEventListener(\"storage\", this.logout, false);\n      }\n    }, {\n      key: \"componentWillUnmount\",\n      value: function componentWillUnmount() {\n        window.removeEventListener(\"storage\", this.logout, false);\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        return __jsx(Page, _extends({}, this.props, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 42,\n            columnNumber: 14\n          }\n        }));\n      }\n    }], [{\n      key: \"getInitialProps\",\n      value: function () {\n        var _getInitialProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n          var req, loggedUser, pageProps, path;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  req = _ref.req;\n                  loggedUser = true ? getUserFromLocalCookie() : getUserFromServerCookie(req);\n                  pageProps = Page.getInitialProps && Page.getInitialProps(req);\n                  console.log(\"is authenticated\");\n                  console.log(loggedUser);\n                  path = req ? req.pathname : \"\";\n                  path = \"\";\n                  return _context.abrupt(\"return\", _objectSpread(_objectSpread({}, pageProps), {}, {\n                    loggedUser: loggedUser,\n                    currentUrl: path,\n                    isAuthenticated: !!loggedUser\n                  }));\n\n                case 8:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        function getInitialProps(_x) {\n          return _getInitialProps.apply(this, arguments);\n        }\n\n        return getInitialProps;\n      }()\n    }]);\n\n    return DefaultPage;\n  }(React.Component), _temp;\n});","map":{"version":3,"sources":["/Users/jennifergerred/Documents/MIT/Week 28/restaurant/components/default.js"],"names":["React","Router","getUserFromServerCookie","getUserFromLocalCookie","Page","eve","key","push","newValue","window","addEventListener","logout","removeEventListener","props","req","loggedUser","pageProps","getInitialProps","console","log","path","pathname","currentUrl","isAuthenticated","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;AAEA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AAEA,SAASC,uBAAT,EAAkCC,sBAAlC,QAAgE,QAAhE;AAEA,gBAAe,UAAAC,IAAI;AAAA;;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA,+DAmBN,UAAAC,GAAG,EAAI;AACd,YAAIA,GAAG,CAACC,GAAJ,KAAY,QAAhB,EAA0B;AACxBL,UAAAA,MAAM,CAACM,IAAP,oBAAwBF,GAAG,CAACG,QAA5B;AACD;AACF,OAvBc;;AAAA;AAAA;;AAAA;AAAA;AAAA,0CAyBK;AAClBC,QAAAA,MAAM,CAACC,gBAAP,CAAwB,SAAxB,EAAmC,KAAKC,MAAxC,EAAgD,KAAhD;AACD;AA3Bc;AAAA;AAAA,6CA6BQ;AACrBF,QAAAA,MAAM,CAACG,mBAAP,CAA2B,SAA3B,EAAsC,KAAKD,MAA3C,EAAmD,KAAnD;AACD;AA/Bc;AAAA;AAAA,+BAiCN;AACP,eAAO,MAAC,IAAD,eAAU,KAAKE,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAP;AACD;AAnCc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEgBC,kBAAAA,GAFhB,QAEgBA,GAFhB;AAGPC,kBAAAA,UAHO,GAGM,OACfZ,sBAAsB,EADP,GAEfD,uBAAuB,CAACY,GAAD,CALd;AAMPE,kBAAAA,SANO,GAMKZ,IAAI,CAACa,eAAL,IAAwBb,IAAI,CAACa,eAAL,CAAqBH,GAArB,CAN7B;AAObI,kBAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACAD,kBAAAA,OAAO,CAACC,GAAR,CAAYJ,UAAZ;AACIK,kBAAAA,IATS,GASFN,GAAG,GAAGA,GAAG,CAACO,QAAP,GAAkB,EATnB;AAUbD,kBAAAA,IAAI,GAAG,EAAP;AAVa,mFAYRJ,SAZQ;AAaXD,oBAAAA,UAAU,EAAVA,UAbW;AAcXO,oBAAAA,UAAU,EAAEF,IAdD;AAeXG,oBAAAA,eAAe,EAAE,CAAC,CAACR;AAfR;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,IACSf,KAAK,CAACwB,SADf;AAAA,CAAnB","sourcesContent":["/* hocs/defaultPage.js */\n\nimport React from \"react\";\nimport Router from \"next/router\";\n\nimport { getUserFromServerCookie, getUserFromLocalCookie } from \"./auth\";\n\nexport default Page =>\n  class DefaultPage extends React.Component {\n    static async getInitialProps({ req }) {\n      const loggedUser = process.browser\n        ? getUserFromLocalCookie()\n        : getUserFromServerCookie(req);\n      const pageProps = Page.getInitialProps && Page.getInitialProps(req);\n      console.log(\"is authenticated\");\n      console.log(loggedUser);\n      let path = req ? req.pathname : \"\";\n      path = \"\";\n      return {\n        ...pageProps,\n        loggedUser,\n        currentUrl: path,\n        isAuthenticated: !!loggedUser\n      };\n    }\n\n    logout = eve => {\n      if (eve.key === \"logout\") {\n        Router.push(`/?logout=${eve.newValue}`);\n      }\n    };\n\n    componentDidMount() {\n      window.addEventListener(\"storage\", this.logout, false);\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener(\"storage\", this.logout, false);\n    }\n\n    render() {\n      return <Page {...this.props} />;\n    }\n  };"]},"metadata":{},"sourceType":"module"}